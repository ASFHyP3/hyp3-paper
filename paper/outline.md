# Paper Outline

## Outline
- Summary
- Statement of need
    - As remote sensing archives become larger its becoming infeasible to process this data locally
    - This has promoted the movement of workflows to the cloud
    - This is particularly true of SAR data, which is larger and more complex
    - Most SAR data require some pre-processing before they are analysis-ready
    - SAR processing is computationally-intensive and requires complicated/expensive software
    - ESA Sentinel-1 mission provides near real-time global SAR monitoring 
        - There is too much satellite imagery for anybody to use
        - On-demand products allow for users to select AOIs for pre-processing workflow
    - State of the field
        - SlideRule
            - Well-designed service for ICESAT missions
        - Descartes Labs
            - Provides cloud SAR processing for larger customers at cost
        - Google Earth Engine
            - Provides services for cloud image processing
            - SAR is not focus
            - Not open source
            - Lacks standardized workflows
        - Microsoft Planetary Computer
            - Open source cloud image processing
            - Limited SAR support
            - Lacks standardized workflows
- HyP3 description
    - HyP3 development history
        - Started as a student summer intern project at UAF in 2016
        - ASF DAAC was entirely on-prem in 2016, and pivot to AWS was on the horizon with rumblings of NISAR
        - Originally designed for either on-prem or AWS
            - Had hybrid of both on-prem and cloud components
            - Emphasis on subscriptions
        - ASF transition to AWS made evident the benefits of transitioning fully to the cloud
            - Distributed first image from S3 in 2016
        - In 2019 HyP3 was rewritten to be cloud native with emphasis on:
            - serverless architecture
            - scalability
            - containerized workflows
            - high-throughput computing
            - utilize new AWS Batch service
        - Release of they HyP3 Python SDK and integration with ASF Data Search (Vertex) website greatly improved usability
        - Public release on HyP3 in 2019, with free processing of RTC/InSAR workflows for anyone
        - Early success led to creation of additional HyP3 deployments for interested partners
            - JPL ACCESS19 project
            - JPL ITS_LIVE MEaSUREs project
            - Alaska Volcano Observatory (AVO)
            - Arizona Department of Water Resources (AZ DWR)
            - Cargill
            - BGC Engineering
        - In 2022 HyP3 was migrated to NASA Earthdata Cloud with stable funding from NASA
    - HyP3 Architecture
        - platform 
            - Figure: [Architecture diagram](https://drive.google.com/file/d/1wZUPGl4pY1qF5ojNSODJ6mF2CAiM-EaT/view?usp=sharing)
                - (buzzwords: - API Gateway, Lambda, DynamoDB, Step Functions, Batch, S3, Docker/Container, ECR, CloudWatch, CloudFormation)
            - Cloud-native (AWS) API-based processing workflow for satellite imagery 
            - High throughput, scalable and cost-effective computing, not high performance computing
            - Designed to work with any image processing pipeline via use of containerized batch jobs for processing
            - Infrastructure as code with AWS CloudFormation Templates
                - CF templates make new, specialized deployments easy
            - API Gateway receives GET, POST requests
            - Post Request logged in DynamoDB NoSQL database
            - AWS Lambda runs on a schedule and watches DynamoDB jobs table for new (PENDING) jobs
            - AWS Step Functions defines workflow for a particular job type
                - Delegate appropriate plugin container and memory requirements for job type
                - Watch for failures, log, and automatically retry
                - Upload completed jobs and updates DynamoDB table with job status (FAILED, SUCCEEDED)
            - AWS Batch runs appropriate plugin container for job type
                - UTILIZES SPOT INSTANCES FOR COST MANAGEMENT
                - Scales according to usage compared to monthly budget allowance (using AWS Cost Explorer)
            - AWS S3 buckets house results download 
                - Output data are publicly available for 2 weeks
        - plugins
            - production (generally available in vertex)
                - HyP3 GAMMA
                    - RTC and InSAR processing workflows on demand
                    - Commercial software 
                - HyP3 autoRIFT
                    - Specialized algorithm finding pixel displacement between two radar or optical images developed by the ITS_LIVE team at JPL `[@Lei:2021]`
            - custom (available in select custom deployments)
                - DockerizedTopsApp
                    - open source InSAR processing for Sentinel-1 Geocoded Unwrapped Interferograms (GUNW)
                - Watermap (ASF Tools?)
                    - Processing utilizing RTC products with different polarizations to estimate surface water extent and depth
                - Riverwidth
                    - processing utilizing RTC product with different polarization to estimate surface water extent and river widths  
            - Plugin development via HyP3 Cookiecutter
                - Template for creating HyP3 containerized plugins
                - Defines the entrypoint so that HyP3 can understand how to run the container
                - CI/CD workflows
                    - support either GitHub Container Registry or AWS ECR
    - HyP3 Usage
        - Programmatic access
            - HyP3 API
                - Swagger UI with OpenAPI specification
                - Can submit and monitor jobs
            - HyP3 SDK
                - Programmatic Python interface to HyP3 API
                - Can submit, monitor, and download jobs
        - Web Access
            - Vertex Integration
                - GUI front-end that allows people to submit RTC jobs, and monitor and download all types of jobs
                - Provides tools for selecting pairs and stacks for InSAR analysis
- Future Work
    - Continued offering of data processing at no cost
    - Expanding suite of HyP3 plugins
    - Additional HyP3 deployments
- Contributors
    - Project managers
    - Student teams
    - Current HyP3 team
    - Writing team
- Acknowledgments
    - All grants that have supported work

## Resources
[HyP3 architecture simplified](https://docs.google.com/document/d/1HcSmjMB9YSBgyqb6WBZpu0euvIrzLlzLuCOI1cssGA0/edit)
[SlideRule Paper](https://joss.theoj.org/papers/10.21105/joss.04982.pdf)
